streaming:
  # Audio settings
  audio_sample_rate: 16000
  audio_chunk_size: 640          # 40ms at 16kHz
  audio_window_frames: 96        # window length in frames (cbh_window_length)
  audio_lookahead_ms_speaker: 60 # speaker lookahead
  audio_lookahead_ms_listener: 0 # listener lookahead
  audio_feature_update_every_n_chunks: 1  # feature recompute frequency

  # Generation settings
  target_fps: 25
  denoising_steps: 3             # Default (configurable 1-10)
  inpainting_length: 94

  # CFG parameters (configurable)
  cfg_audio: 0.5
  cfg_audio_other: 0.5
  cfg_anchor: 0.0
  cfg_all: 1.0

  # Optimization — KV-cache
  use_kv_cache: true                        # KV-cache for GPT autoregressive loop (saves ~50% on 2nd iteration)
  use_torch_compile_gpt_loop: true          # torch.compile the full GPT block loop (adds ~15s to first-run warmup)

  # Optimization — torch.compile
  use_torch_compile_motion: false           # Compile GPT blocks (incompatible with KV-cache; +2ms without KV-cache)
  use_torch_compile_flow_estimator: true    # torch.compile flow_estimator (max-autotune-no-cudagraphs)
  use_torch_compile_face_generator: true    # torch.compile face_generator (max-autotune-no-cudagraphs)
  use_torch_compile_render_combined: true   # Compile flow+face as single graph (overrides individual compiles)
  frame_encoding_quality: 80               # JPEG quality (speed vs size)

  # Optimization — TensorRT (requires tensorrt + torch-tensorrt packages)
  use_tensorrt: true                        # Master TRT switch
  use_tensorrt_wav2vec: false                # DISABLED: FP16 TRT degrades Wav2Vec2 attention accuracy
  use_tensorrt_face_generator: false         # DISABLED: torch_tensorrt incompatible with SPADE decoder; torch.compile used
  use_tensorrt_diffusion_head: true         # torch_tensorrt for diffusion MLP head
  tensorrt_cache_dir: "streaming_app/cache/tensorrt"  # Engine cache directory

  # Optimization — MediaPipe
  use_mediapipe_gpu: true                   # Try GPU delegate (fallback to CPU)

  # Buffering
  client_buffer_frames: 1        # Minimal buffering
  server_buffer_frames: 2        # Generate-ahead

  # Multi-user settings
  max_concurrent_sessions: 2
  gpu_memory_per_session_gb: 6

  # Paths
  checkpoint_path: "checkpoints/last.ckpt"
  tools_path: "tools/visualization_0416"
  default_avatars_path: "streaming_app/assets/default_avatars"

  # Network
  websocket_ping_interval: 30
  websocket_ping_timeout: 10
  max_message_size: 10485760  # 10MB for image uploads
